window.onload=function(){function e(e){if(b)window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){(new Date).getTime();e(WebViewJavascriptBridge)},!1);else{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}}function i(i,a,n,s){var r=new Object;(new Date).getDate();e(function(e){C++,b&&1==C&&e.init(),e.callHandler("webCallApp",{iNeed:"you",uri:i},function(e){r=e,b&&(r=JSON.parse(r)),n&&!t(n)&&$.extend(r,n),s?a(r,s):a(r)})})}function t(e){var i;for(i in e)return!1;return!0}function a(i){i.topName&&""!=i.topName||(i.topName=""),i.title&&""!=i.title||(i.title=""),i.image&&""!=i.image||(i.image=""),i.describe&&""!=i.describe||(i.describe=""),i.shareurl&&""!=i.shareurl||(i.shareurl=""),e(function(e){e.callHandler("webCallApp",{topName:i.topName,title:i.title,image:i.image,describe:i.describe,shareurl:i.shareurl},function(e){JSON.stringify(e)})})}function n(i){if(i.wechat&&""!=i.wechat){e(function(e){C++,b&&1==C&&e.init(),e.callHandler("webCallApp",{wechat:i.wechat,shareObj:i.shareObj},function(e){})})}}function s(e,i){wx.config(e),wx.ready(function(){wx.onMenuShareAppMessage(i),wx.onMenuShareTimeline(i)})}function r(){$.ajax({type:"GET",url:u+"/wx/api/oauth/wxshare",success:function(e){1==e.code&&s(e.data,k)},error:function(e){console.log("err",e)}})}function l(e){if(e.length>0){for(var i="",t=0;t<e.length;t++)i+='<li class="list" id='+e[t].articleidStr+'><img class="list-img" src='+e[t].imageUrl+' alt=""><div class="list-r"> <p class="els3"> '+e[t].title+"</p></div> </li>";$("#lis").html(i)}$("#lis li").click(function(){var e=$(this).attr("id");window.location.href="/app/article/detail/"+e+".html"})}function o(e){os&&(0==e||""==e?($("#isPraise").removeClass("cancellike").addClass("like"),d("已取消喜欢",1)):1==e?($("#isPraise").removeClass("like").addClass("cancellike"),d("已喜欢",1)):$("#isPraise").css("display","none"))}function c(e){$.ajax({type:"POST",url:u+"/costin/mapi/article/praise",data:e,success:function(e){var i=$("#praiseCount").html();if(1==e.code){if(o(v),1==v)return v=0,i-=1,$("#praiseCount").html(i),void o(v);if(0==v)return v=1,i++,$("#praiseCount").html(i),void o(v)}},error:function(e){console.log(e),e=JSON.stringify(e)}})}function d(e,i){i?i*=1e3:i=2e3;var t=$("<div id='toast'></div>");$("body").append(t);var a={display:"none",background:"rgba(0, 0, 0, 0.3)",position:"fixed","z-index":"10",width:"4rem","line-height":"0.8rem",left:"3rem",top:"50%","margin-top":" -0.66666667rem","border-radius":" 0.16rem","font-size":"0.4rem",color:"white","text-align":" center",padding:"0.26666667rem 0.13333333rem"};$("#toast").css(a),$("#toast").css("display","block").html(e),setTimeout(function(){$("#toast").css("display","none").html()},i)}var u=myRoutes(),m=function(){var e=window.location.pathname,i=e.lastIndexOf("/");if((e=e.substring(i+1,e.length)).indexOf("html"))return e=e.split(".")[0]}(),p=function(){var e=location.search,i=new Object;if(-1!=e.indexOf("?")){var t=e.substr(1);strs=t.split("&");for(var a=0;a<strs.length;a++)i[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}return i}(),f="/costin/mapi/article",h={articleid:m,type:1,isApp:0};p.type&&(h.type=p.type);var g=window.navigator.userAgent,w=window.navigator.platform;detect(g,w);var b=os.android;os.daodaoclub&&$(".inApp").css("display","block"),function(e){$.ajax({type:"POST",url:u+f,data:e,success:function(e){if(1==e.code){var t=e.original;document.title=t.title,$("#title").html(t.title),$("#subtitle").html(t.subTitle);var s=t.content;$("#content").html(s),0==(v=t.isPraise)||""==v?($("#isPraise").hasClass("cancellike")&&$(this).removeClass("cancellike"),$("#isPraise").addClass("like")):1==v?($("#isPraise").hasClass("like")&&$("#isPraise").removeClass("like"),$("#isPraise").addClass("cancellike")):$("#isPraise").css("display","none");var o=t.praiseCount;$("#praiseCount").html(o),t.articleid;var d=t.share;k.title=d.showTitle,k.desc=d.subtitle,k.imgUrl=d.imgurl,k.link=d.url,r(),y.shareurl=d.url,y.title=d.showTitle,y.describe=d.subtitle,y.image=d.imgurl,a(y),l(e.original.recommend),$("#isPraise").click(function(){i("/costin/mapi/article/praise",c,{articleid:t.articleid})}),$("#sharefriend").click(function(){n({wechat:"message",shareObj:y}),a(y)}),$("#sharetimeline").click(function(){n({wechat:"timeline",shareObj:y}),a(y)})}},error:function(e){console.log(e)}})}(h);var v="",C=0,k={link:window.location.href,title:document.title,desc:"",imgUrl:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",success:function(){},cancel:function(){}},y={topName:document.title,shareurl:window.location.href,title:"document.title",image:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",describe:""}};