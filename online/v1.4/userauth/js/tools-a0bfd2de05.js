function getUserid(){var e=location.search,t=new Object;if(-1!=e.indexOf("?")){var a=e.substr(1);strs=a.split("&");for(var n=0;n<strs.length;n++)t[strs[n].split("=")[0]]=unescape(strs[n].split("=")[1])}return t}function getUri(e){var t=e.split("//"),a=t[1].indexOf("/"),n=t[1].substring(a);return-1!=n.indexOf("?")&&(n=n.split("?")[0]),n}function myRoutes(){return"http://m.daodaoclub.com"}function isEmptyObject(e){var t;for(t in e)return!1;return!0}function setupWebViewJavascriptBridge(e){if(android)window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){(new Date).getTime();e(WebViewJavascriptBridge)},!1);else{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var t=document.createElement("iframe");t.style.display="none",t.src="https://__bridge_loaded__",document.documentElement.appendChild(t),setTimeout(function(){document.documentElement.removeChild(t)},0)}}function OCJSJAVA(e,t,a,n){var s=new Object;(new Date).getDate();setupWebViewJavascriptBridge(function(i){index++,android&&1==index&&i.init(),i.callHandler("webCallApp",{iNeed:"you",uri:e},function(e){s=e,android&&(s=JSON.parse(s)),a&&!isEmptyObject(a)&&$.extend(s,a),n?t(s,n):t(s)})})}function appShareWX(e){e.topName&&""!=e.topName||(e.topName=""),e.title&&""!=e.title||(e.title=""),e.image&&""!=e.image||(e.image=""),e.describe&&""!=e.describe||(e.describe=""),e.shareurl&&""!=e.shareurl||(e.shareurl=""),setupWebViewJavascriptBridge(function(t){t.callHandler("webCallApp",{topName:e.topName,title:e.title,image:e.image,describe:e.describe,shareurl:e.shareurl},function(e){JSON.stringify(e)})})}function deleteOs(e,t,a){a||(a=new Object),isWechat?_unionid&&""!=_unionid?(a._unionid=_unionid,e(a)):getUnionid(search):isApp&&OCJSJAVA(t,e,a)}function setCookie(e,t){var a=new Date;a.setTime(a.getTime()+864e5),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()}function getCookies(e){for(var t,a=document.cookie.replace(/[ ]/g,"").split(";"),n=0;n<a.length;n++){var s=a[n].split("=");if(e==s[0]){t=unescape(s[1]).substring(0,s[1].length);break}}return t}function delCookie(e){var t=new Date;t.setTime(t.getTime()-1);var a=getCookies(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString())}function gettimestamp(){return(new Date).getTime()}function copyToClipboard(e){if(os.ios){var t=document.querySelector("#"),a=document.createRange();a.selectNode(t),window.getSelection().addRange(a);var n=document.execCommand("copy");try{var s=n?"successful":"unsuccessful";console.log("copy is"+s)}catch(e){console.log("Oops, unable to copy")}window.getSelection().removeAllRanges()}else if(os.android){var i=document.createElement("input"),o=document.getElementById(e).innerHTML||document.getElementById(e).value;i.setAttribute("value",o),document.body.appendChild(i),i.select(),document.execCommand("copy"),toast(document.execCommand("copy")),document.body.removeChild(i)}}function toast(e){var t=$("<div id='toast'></div>");$("body").append(t);var a={display:"none",background:"rgba(0, 0, 0, 0.7)",position:"fixed","z-index":"10",width:"4rem","line-height":"0.8rem",left:"3rem",top:"50%","margin-top":" -0.66666667rem","border-radius":" 0.16rem","font-size":"0.4rem",color:"white","text-align":" center",padding:"0.26666667rem 0.13333333rem"};$("#toast").css(a),$("#toast").css("display","block").html(e),setTimeout(function(){$("#toast").css("display","none").html()},2e3)}function getFormData(e,t){$.ajax({type:"GET",url:route+"/costin/mapi/authentication/after",data:e,success:function(e){1==e.code?t(e.original):toast(e.msg)},error:function(e){console.log(e)}})}function timestamp(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),s=e.getHours(),i=e.getMinutes(),o=e.getSeconds();return""+t+add0(a)+"/"+add0(n)+add0(s)+add0(i)+add0(o)}function add0(e){return e<10?"0"+e:e}function times(){var e=new Date,t=(e.getFullYear(),e.getMonth(),e.getDate()),a=e.getHours(),n=e.getMinutes(),s=e.getSeconds();return add0(t)+add0(a)+add0(n)+add0(s)}function renderLast(e){if(""!=e.alumni1Name&&($("#alumni1Name").val(e.alumni1Name),name_state2=!0),""!=e.alumni1Classes)if(-1!=e.alumni1Classes.indexOf(",")){t=e.alumni1Classes.split(",");$("#alumni1Classes").val(t[1]),classes_state1=!0,$("#alumni1Major").val(t[0]),major_state1=!0}else $("#alumni1Classes").val(e.alumni1Classes),classes_state1=!0;if(""!=e.alumni1Phone&&($("#alumni1Phone").val(e.alumni1Phone),phone_state1=!0),""!=e.alumni2Name&&($("#alumni2Name").val(e.alumni2Name),name_state2=!0),""!=e.alumni2Phone&&($("#alumni2Phone").val(e.alumni2Phone),phone_state2=!0),""!=e.alumni2Classes)if(-1!=e.alumni2Classes.indexOf(",")){var t=e.alumni2Classes.split(",");$("#alumni2Classes").val(t[1]),classes_state2=!0,$("#alumni2Major").val(t[0]),major_state2=!0}else $("#alumni2Classes").val(e.alumni2Classes),classes_state2=!0;buttonChange2()}function imgCss(e){return{background:(e='url("'+e+'")')+" no-repeat center center","background-size":"cover"}}function getImgUrl(e){return e.indexOf('("')>-1?e=e.split('("')[1].split('")')[0]:e.indexOf("(")>-1&&(e=e.split("(")[1].split(")")[0]),e}function buttonChange2(){phone_state1&&phone_state2&&major_state1&&major_state2&&classes_state1&&classes_state2&&name_state1&&name_state2?$(".next-button").css("background","#cb9555"):$(".next-button").css("background","#cccccc")}function buttonChange(){console.log("head_state:"+head_state,"name_state:"+name_state,"company_state:"+company_state),head_state&&name_state&&company_state?$(".next-button").css("background","#cb9555"):$(".next-button").css("background","#cccccc")}function renderAfter(e){if(""!=e.name&&($("#name").val(e.name),name_state=!0),""!=e.headUrl){var t=imgCss(e.headUrl);$("#headUrl").css(t),head_state=!0}""!=e.companyImg&&($("#companyImg").css(imgCss(e.companyImg)),$("#companyImg").parents("label").next().css("display","block"),company_state=!0),""!=e.collegeImg&&($("#collegeImg").css(imgCss(e.companyImg)),$("#collegeImg").parents("label").next().css("display","block")),buttonChange()}function postDataFirst(e){var t=$("#name").val();if(""!=t){var a=getImgUrl($("#headUrl").css("background-image"));if("none"!=a&&null!=a){var n=getImgUrl($("#companyImg").css("background-image"));if(null==n||n.indexOf("img/upload.png")>-1)toast("请选择照片");else{var s=getImgUrl($("#collegeImg").css("background-image"));(null==s||s.indexOf("img/upload.png")>-1)&&(s="");var i={headUrl:a,name:t,companyImg:n,collegeImg:s};$.extend(e,i),$.ajax({type:"POST",url:route+"/costin/mapi/authentication",data:e,success:function(e){1==e.code?window.location.href="/app/userauth/formtwo.html?_t="+times():toast(e.msg)},error:function(e){console.log(e)}})}}else toast("请选择头像")}else toast("请输入姓名！")}function postDataLast(e){var t=$("#alumni1Name").val(),a=$("#alumni1Major").val(),n=$("#alumni1Classes").val(),s=$("#alumni1Phone").val(),i=$("#alumni2Name").val(),o=$("#alumni2Phone").val(),l=$("#alumni2Major").val(),r=$("#alumni2Classes").val();if(""!=t&&""!=a&&""!=n&&""!=s&&""!=i&&""!=o&&""!=l&&""!=r){var c={alumni1Name:t,alumni1Phone:s,alumni1Classes:a+","+n,alumni2Name:i,alumni2Phone:o,alumni2Classes:l+","+r};$.extend(e,c),$.ajax({type:"POST",url:route+"/costin/mapi/authentication/later",data:e,success:function(e){1==e.code?window.location.href="/app/userauth/success.html":toast(e.msg)},error:function(e){console.log(e)}})}else toast("请填写完全部内容")}function postPhoto(e,t){var a=e.parent().find("label .oss"),n=e.parent().find(".close-img"),s=e[0].files[0],i=e.val();if(0!=s.size){var o=s.type;if(/(?:jpg|gif|png|jpeg)$/i.test(o))if(s.size>4194304)toast("上传的图片的大于2M,请重新选择");else{var l=i.substr(i.indexOf(".")),r="user/apply/"+timestamp()+l;client.multipartUpload(r,s).then(function(e){var s="url("+("http://img.daodaoclub.com/"+e.name)+")";a.removeClass("bac-after").addClass("bac-before").css("background-image",s),n.css("display","block"),t&&t()}).catch(function(e){console.log(e)})}else toast("您上传图片的类型不符合(.jpg|.jpeg|.gif|.png)！")}}var route=myRoutes(),ua=this.navigator.userAgent,platform=this.navigator.platform;detect(ua,platform);var android=os.android,index=0,_unionid=getCookies("_unionid"),isApp=os.daodaoclub,isWechat=os.micromessenger,search=getUserid(),head_state=!1,name_state=!1,company_state=!1,phone_state1=!1,phone_state2=!1,name_state1=!1,name_state2=!1,major_state1=!1,major_state2=!1,classes_state1=!1,classes_state2=!1,client=new OSS.Wrapper({region:"oss-cn-shanghai",accessKeyId:"LTAIQXyCzQ8P9jEC",accessKeySecret:"XUt1mgNViGNq2hPGISX8klqreWgxEb",bucket:"daodao-upload"});