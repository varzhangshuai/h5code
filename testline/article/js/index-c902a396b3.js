window.onload=function(){function e(e){if(v)window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){(new Date).getTime();e(WebViewJavascriptBridge)},!1);else{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}}function i(i,a,n,s){var r=new Object;(new Date).getDate();e(function(e){k++,v&&1==k&&e.init(),e.callHandler("webCallApp",{iNeed:"you",uri:i},function(e){r=e,v&&(r=JSON.parse(r)),n&&!t(n)&&$.extend(r,n),s?a(r,s):a(r)})})}function t(e){var i;for(i in e)return!1;return!0}function a(i){i.topName&&""!=i.topName||(i.topName=""),i.title&&""!=i.title||(i.title=""),i.image&&""!=i.image||(i.image=""),i.describe&&""!=i.describe||(i.describe=""),i.shareurl&&""!=i.shareurl||(i.shareurl=""),i.topShare&&""!=i.topShare||(i.topShare=0),e(function(e){e.callHandler("webCallApp",{topShare:i.topShare,topName:i.topName,title:i.title,image:i.image,describe:i.describe,shareurl:i.shareurl},function(e){JSON.stringify(e)})})}function n(i){if(i.wechat&&""!=i.wechat){e(function(e){k++,v&&1==k&&e.init(),e.callHandler("webCallApp",{wechat:i.wechat,shareObj:i.shareObj},function(e){})})}}function s(e,i){wx.config(e),wx.ready(function(){wx.onMenuShareAppMessage(i),wx.onMenuShareTimeline(i)})}function r(){$.ajax({type:"GET",url:p+"/wx/api/oauth/wxshare",success:function(e){1==e.code&&s(e.data,y)},error:function(e){console.log("err",e)}})}function o(e){$.ajax({type:"POST",url:p+h,data:e,success:function(e){if(1==e.code){var t=e.original;$("#title").html(t.title),$("#subtitle").html(t.subTitle);var s=t.content;$("#content").html(s);var o=t.articleid;C=t.isPraise;var c={objectid:o,type:2};i("/costin/mapi/praise/get",u,c),$("#isPraise").click(function(){i("/costin/mapi/praise",d,c),a(O)});var p=t.share;y.title=p.showTitle,y.desc=p.subtitle,y.imgUrl=p.imgurl,y.link=p.url,r(),O.shareurl=p.url,O.title=p.showTitle,O.describe=p.subtitle,O.image=p.imgurl,a(O),l(e.original.recommend),$("#sharefriend").click(function(){n({wechat:"message",shareObj:O}),a(O)}),$("#sharetimeline").click(function(){n({wechat:"timeline",shareObj:O}),a(O)})}},error:function(e){console.log(e)}})}function l(e){if(e.length>0){for(var i="",t=0;t<e.length;t++)i+='<li class="list" id='+e[t].articleidStr+'><img class="list-img" src='+e[t].imageUrl+' alt=""><div class="list-r"> <p class="els3"> '+e[t].title+"</p></div> </li>";$("#lis").html(i)}$("#lis li").click(function(){var e=$(this).attr("id");window.location.href="/app/article/detail/"+e+".html"})}function c(e){os&&(0==e||""==e?$("#isPraise").removeClass("cancellike").addClass("like"):1==e?$("#isPraise").removeClass("like").addClass("cancellike"):$("#isPraise").css("display","none"))}function d(e){$.ajax({type:"POST",url:p+"/costin/mapi/praise",data:e,success:function(e){var i=$("#praiseCount").html();if(1==e.code){if(c(C),1==C)return C=0,i-=1,$("#praiseCount").html(i),void c(C);if(0==C)return C=1,i++,$("#praiseCount").html(i),void c(C)}},error:function(e){console.log(e),e=JSON.stringify(e)}})}function u(e){$.ajax({type:"POST",url:p+"/costin/mapi/praise/get",data:e,success:function(e){if(1==e.code){var i=e.original.praiseCount;0==(C=e.original.isPraise)||""==C?($("#isPraise").hasClass("cancellike")&&$(this).removeClass("cancellike"),$("#isPraise").addClass("like")):1==C?($("#isPraise").hasClass("like")&&$("#isPraise").removeClass("like"),$("#isPraise").addClass("cancellike")):$("#isPraise").css("display","none"),$("#praiseCount").html(i)}},error:function(e){console.log("err",e)}})}var p=myRoutes(),m=function(){var e=window.location.pathname,i=e.lastIndexOf("/");if((e=e.substring(i+1,e.length)).indexOf("html"))return e=e.split(".")[0]}(),f=function(){var e=location.search,i=new Object;if(-1!=e.indexOf("?")){var t=e.substr(1);strs=t.split("&");for(var a=0;a<strs.length;a++)i[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}return i}(),h="/costin/mapi/article",g={articleid:m,type:1,isApp:0};f.type&&(g.type=f.type);var w=window.navigator.userAgent,b=window.navigator.platform;detect(w,b);var v=os.android;os.daodaoclub?($(".inApp").css("display","block"),i(h,o,g)):(o(g),$(".padding").css("display","block"),$(".float-bottom").css("display","block"));var C="",k=0,y={link:window.location.href,title:document.title,desc:"",imgUrl:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",success:function(){},cancel:function(){}},O={topName:document.title,shareurl:window.location.href,title:document.title,image:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",describe:"",topShare:1}};