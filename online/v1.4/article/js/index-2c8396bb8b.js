window.onload=function(){function e(e){if(g)window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){(new Date).getTime();e(WebViewJavascriptBridge)},!1);else{if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}}function i(i,a,n,r){var l=new Object;(new Date).getDate();e(function(e){v++,g&&1==v&&e.init(),e.callHandler("webCallApp",{iNeed:"you",uri:i},function(e){l=e,g&&(l=JSON.parse(l)),n&&!t(n)&&$.extend(l,n),r?a(l,r):a(l)})})}function t(e){var i;for(i in e)return!1;return!0}function a(i){i.topName&&""!=i.topName||(i.topName=""),i.title&&""!=i.title||(i.title=""),i.image&&""!=i.image||(i.image=""),i.describe&&""!=i.describe||(i.describe=""),i.shareurl&&""!=i.shareurl||(i.shareurl=""),i.topShare&&""!=i.topShare||(i.topShare=0),e(function(e){e.callHandler("webCallApp",{topShare:i.topShare,topName:i.topName,title:i.title,image:i.image,describe:i.describe,shareurl:i.shareurl},function(e){JSON.stringify(e)})})}function n(i){if(i.wechat&&""!=i.wechat){e(function(e){v++,g&&1==v&&e.init(),e.callHandler("webCallApp",{wechat:i.wechat,shareObj:i.shareObj},function(e){})})}}function r(e,i){wx.config(e),wx.ready(function(){wx.onMenuShareAppMessage(i),wx.onMenuShareTimeline(i)})}function l(){$.ajax({type:"GET",url:d+"/wx/api/oauth/wxshare",success:function(e){1==e.code&&r(e.data,C)},error:function(e){console.log("err",e)}})}function s(e){if(e.length>0){for(var i="",t=0;t<e.length;t++)i+='<li class="list" id='+e[t].articleidStr+'><img class="list-img" src='+e[t].imageUrl+' alt=""><div class="list-r"> <p class="els3"> '+e[t].title+"</p></div> </li>";$("#lis").html(i)}$("#lis li").click(function(){var e=$(this).attr("id");window.location.href="/app/article/detail/"+e+".html"})}function o(e){os&&(0==e||""==e?$("#isPraise").removeClass("cancellike").addClass("like"):1==e?$("#isPraise").removeClass("like").addClass("cancellike"):$("#isPraise").css("display","none"))}function c(e){$.ajax({type:"POST",url:d+"/costin/mapi/article/praise",data:e,success:function(e){var i=$("#praiseCount").html();if(1==e.code){if(o(b),1==b)return b=0,i-=1,$("#praiseCount").html(i),void o(b);if(0==b)return b=1,i++,$("#praiseCount").html(i),void o(b)}},error:function(e){console.log(e),e=JSON.stringify(e)}})}var d=myRoutes(),u=function(){var e=window.location.pathname,i=e.lastIndexOf("/");if((e=e.substring(i+1,e.length)).indexOf("html"))return e=e.split(".")[0]}(),p=function(){var e=location.search,i=new Object;if(-1!=e.indexOf("?")){var t=e.substr(1);strs=t.split("&");for(var a=0;a<strs.length;a++)i[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}return i}(),m="/costin/mapi/article",f={articleid:u,type:1,isApp:0};p.type&&(f.type=p.type);var h=window.navigator.userAgent,w=window.navigator.platform;detect(h,w);var g=os.android;os.daodaoclub&&$(".inApp").css("display","block"),function(e){$.ajax({type:"POST",url:d+m,data:e,success:function(e){if(1==e.code){var t=e.original;document.title=t.title,$("#title").html(t.title),$("#subtitle").html(t.subTitle);var r=t.content;$("#content").html(r),0==(b=t.isPraise)||""==b?($("#isPraise").hasClass("cancellike")&&$(this).removeClass("cancellike"),$("#isPraise").addClass("like")):1==b?($("#isPraise").hasClass("like")&&$("#isPraise").removeClass("like"),$("#isPraise").addClass("cancellike")):$("#isPraise").css("display","none");var o=t.praiseCount;$("#praiseCount").html(o),t.articleid;var d=t.share;C.title=d.showTitle,C.desc=d.subtitle,C.imgUrl=d.imgurl,C.link=d.url,l(),k.shareurl=d.url,k.title=d.showTitle,k.describe=d.subtitle,k.image=d.imgurl,a(k),s(e.original.recommend),$("#isPraise").click(function(){i("/costin/mapi/article/praise",c,{articleid:t.articleid})}),$("#sharefriend").click(function(){n({wechat:"message",shareObj:k}),a(k)}),$("#sharetimeline").click(function(){n({wechat:"timeline",shareObj:k}),a(k)})}},error:function(e){console.log(e)}})}(f);var b="",v=0,C={link:window.location.href,title:document.title,desc:"",imgUrl:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",success:function(){},cancel:function(){}},k={topName:document.title,shareurl:window.location.href,title:"document.title",image:"http://img.daodaoclub.com/daodao_logo/daodao_logo_100.png",describe:"",topShare:1}};